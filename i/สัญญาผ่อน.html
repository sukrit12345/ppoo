<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<title>ตารางสัญญาผ่อนรายบุคคล</title>

<style>
.navbar {
        overflow: hidden;
        background-color: #333;
        position: fixed;
        top: 0;
        width: 100%;
        left: 0;
        right: 0;
    }
.navbar a {
        float: left;
        display: block;
        color: white;
        text-align: center;
        padding: 14px 20px;
        text-decoration: none;
    }
.navbar a:hover {
        background-color: #ddd;
        color: black;
    }
.navbar a.active {
        background-color: #555;
        color: white;
    }
    

body {
        font-family: Arial, sans-serif;
        background-color: #ffffff;
        margin-top: 100px;
    }

.container {
  width: 60%;
  margin: auto;
  margin-top: 50px;
}

table {
        border-collapse: collapse;
        width: 100%;
        margin: auto;
        margin-top: 80px;
    }

th, td {
        border: 1px solid #dddddd;
        text-align: center;
        padding: 8px;
    }

th {
        background-color: #333;
        color: white;
    }

tr:nth-child(even) {
        background-color: #f2f2f2;
    }    




.button-container {
    display: flex;
    justify-content: center;
    margin-top: 40px;
}

.column {

    margin: 10px; /* Adjust the margin as needed */
}


.custom-button {
    background-color: #4CAF50;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

.custom-button:hover {
    background-color: #45a049;
}

.button-link {
    text-decoration: none;
    color: white;
}



.s {
   color: green;
}


.b {
    color: red;
}
.w {
    color: rgb(26, 133, 233);
}

.l {
    color: rgb(242, 160, 9);
}
.d{
    color:rgb(248, 7, 204);
}



</style>
</head>
<body>
  <div class="navbar">
    <a href="ข้อมูลลูกหนี้.html">ข้อมูลลูกหนี้</a>
    <a href="รายงานผล.html">รายงานผล</a>
    <a href="เช็คสถานะ.html">เช็คสถานะ</a>
    <a class="active" href="คลังทรัพย์สิน.html">คลังทรัพย์สิน</a>
    <a href="ผู้จัดการ.html">ผู้จัดการ</a>
    <a href="กองทุน.html">กองทุน</a>
    <a href="ประวัติการทำรายการ.html">ประวัติการทำรายการ</a>
    <a href="เเจ้งเตือน.html">เเจ้งเตือน</a>
    <a href="ตั้งค่า.html">ตั้งค่า</a>
 </div> 

<h2 style="text-align:center;">ตารางสัญญาผ่อนรายบุคคล</h2>



<div style="text-align: center;">เลขบัตรประชาชน: 9876543210987</div>
<div style="text-align: center;">ชื่อ: Jane</div>
<div style="text-align: center;">นามสกุล: Smith</div>
<br>

<div style="text-align: center;">ผู้จัดการ: John Smith</div>
<div style="text-align: center;">ผู้ดูเเล: -</div>
<div style="text-align: center;">หัวหน้าสาขา: John Smith</div>
<br>
<br>


<div class="button-container">
    <div class="column">
        <button class="custom-button">
            <a href="สร้างสัญญาผ่อน.html" class="button-link">สร้างสัญญาผ่อน</a>
        </button>
    </div>
</div>






<script>
  function confirmDelete() {
      if (confirm("คุณต้องการทำรายการนี้ใช่หรือไม่?")) {
          location.href = 'สัญญา.html';
      } else {
          // ไม่ต้องทำอะไร
      }
  }
</script>


<script>
  function confirmclose() {
      if (confirm("คุณต้องการปิดสัญญานี้ใช่หรือไม่?")) {
          location.href = 'สัญญา.html';
      } else {
          // ไม่ต้องทำอะไร
      }
  }
</script>







<table id="your_table_id">
  <tr>
    <th>ลำดับ</th>
    <th>รหัสสร้างสัญญา</th>
    <th>บิล</th>
    <th>วันที่กู้</th>
    <th>ระยะเวลากู้</th>
    <th>วันที่ต้องคืน</th>
    <th>เงินต้น</th>
    <th>ดอกเบี้ย</th>
    <th>ดอกเบี้ยปรับ</th>
    <th>ดอกเบี้ยยกมา</th>
    <th>รวมดอกเบี้ยที่ต้องคืน</th>
    <th>เงินที่ต้องคืน</th>
    <th>สถานะ</th>
    <th>เลยกำหนดสัญญา</th>
    <th>จัดการสัญญา</th>
    <th>ยึดทรัพย์</th>
    <th>คืนเงิน</th>
  </tr>

  <tr>
    <td>-</td>
    <td>003</td>
    <td>01</td>
    <td>2024-04-19</td>
    <td>5วัน</td>
    <td>2024-04-29</td>
    <td>1000</td>
    <td>100</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
 </tr>
  


  <tr>
    <td>-</td>
    <td>003</td>
    <td>01</td>
    <td>2024-04-19</td>
    <td>1วัน</td>
    <td>2024-04-30</td>
    <td>1000</td>
    <td>20</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
 </tr>
  


  <tr>
    <td>-</td>
    <td>003</td>
    <td>01</td>
    <td>2024-04-19</td>
    <td>1วัน</td>
    <td>2024-04-28</td>
    <td>1000</td>
    <td>20</td>
    <td></td>
    <td>50</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
 </tr>

 <tr>
    <td>-</td>
    <td>002</td>
    <td>04</td>
    <td>2024-06-02</td>
    <td>5วัน</td>
    <td>2024-05-01</td>
    <td>1000</td>
    <td>100</td>
    <td></td>
    <td>100</td>
    <td></td>
    <td></td>
    <td ></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
 </tr>

  
  <tr>
    <td>-</td>
    <td>002</td>
    <td>04</td>
    <td>2024-06-02</td>
    <td>5วัน</td>
    <td>2024-06-07</td>
    <td>1000</td>
    <td>100</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td ></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
 </tr>


 
 <tr>
    <td>-</td>
    <td>002</td>
    <td>03</td>
    <td>2024-05-18</td>
    <td>5วัน</td>
    <td>2024-05-23</td>
    <td>1000</td>
    <td>100</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
 </tr>


  <tr>
    <td>-</td>
    <td>002</td>
    <td>03</td>
    <td>2024-05-18</td>
    <td>5วัน</td>
    <td>2024-05-23</td>
    <td>1000</td>
    <td>100</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td ></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
 </tr>

  <tr>
    <td>-</td>
    <td>002</td>
    <td>02</td>
    <td>2024-05-13</td>
    <td>5วัน</td>
    <td>2024-05-18</td>
    <td>1000</td>
    <td>100</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
 </tr>

 <tr>
    <td>-</td>
    <td>002</td>
    <td>01</td>
    <td>2024-05-08</td>
    <td>5วัน</td>
    <td>2024-05-13</td>
    <td>1000</td>
    <td>100</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
 </tr>

 <tr>
    <td></td>
    <td>001</td>
    <td>01</td>
    <td>2024-05-03</td>
    <td>5วัน</td>
    <td>2024-05-08</td>
    <td>1000</td>
    <td>100</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
 </tr>

</table>


<script>
    // เลือกตาราง
    var table = document.querySelector('#your_table_id');
    // เลือกแถวของตาราง
    var rows = Array.from(table.querySelectorAll('tr'));

    // วนลูปทุกแถวเพื่อกำหนดลำดับตัวเลขจากมากไปน้อย
    rows.forEach(function(row, index) {
        // ตรวจสอบว่าไม่ใช่แถวแรก
        if (index > 0) {
            // สร้างเซลล์แรกของแถว
            var cell = row.cells[0]; // เซลล์แรกมี index เป็น 0
            // กำหนดลำดับลงในเซลล์แรกของแถว โดยเรียงจากมากไปน้อย
            cell.textContent = rows.length - index; 
        }
    });
</script>


<script>
    // เลือกตาราง
    var table = document.querySelector('#your_table_id');
    // เลือกแถวของตาราง
    var rows = table.querySelectorAll('tr');

    // เก็บค่าเริ่มต้นของลำดับตัวเลข
    var initialIndex = 1;

    // วนลูปทุกแถวเพื่อเพิ่มลำดับตัวเลขในเซลล์ที่ 2 โดยไม่นับแถวแรก
    for (var i = 1; i < rows.length; i++) {
        var row = rows[i];
        // เลือกเซลล์ที่ 1 ของแถว
        var cell1 = row.cells[1];
        // เช็คว่าข้อมูลในเซลล์ที่ 1 เปลี่ยนแปลงหรือไม่
        if (cell1.textContent !== '') {
            // หากเปลี่ยนแปลงให้เริ่มนับลำดับใหม่
            initialIndex = 1;
        }
        // เลือกเซลล์ที่ 2 ของแถว
        var cell2 = row.cells[2];
        // กำหนดลำดับตัวเลข (จากมากไปน้อย)
        cell2.textContent = initialIndex;
        // เพิ่มลำดับตัวเลข
        initialIndex++;
    }
</script>





<script>
    // เลือกตาราง
    var table = document.querySelector('#your_table_id');
    // เลือกแถวของตาราง
    var rows = table.querySelectorAll('tr');

    // วนลูปทุกแถวเพื่อเพิ่มปุ่มในเซลล์ที่ 14, 15, และ 16 โดยไม่นับแถวแรก
    for (var i = 1; i < rows.length; i++) {
        var row = rows[i];
        
        // สร้างปุ่ม "ดู"
        var viewCell = row.cells[14];
        var viewButton = document.createElement('button');
        viewButton.textContent = 'ดู';
        viewButton.onclick = function() {
            location.href = 'ดูสัญญาที่สร้าง.html';
        };
        viewCell.appendChild(viewButton);

        // สร้างปุ่ม "แก้ไข"
        var editCell = row.cells[14]; // แก้ไขตำแหน่งของเซลล์เป็น [13]
        var editButton = document.createElement('button');
        editButton.textContent = 'ปิด';
        editButton.onclick = function() {
            location.href = 'ปิด.html'; // แก้ไขการกำหนดลิงค์ไปยังหน้าแก้ไข
        };
        editCell.appendChild(editButton);

        // สร้างปุ่ม "ลบ"
        var deleteCell = row.cells[14]; // แก้ไขตำแหน่งของเซลล์เป็น [14]
        var deleteButton = document.createElement('button');
        deleteButton.textContent = 'ลบ';
        deleteButton.onclick = function() {
            confirmDelete();
        };
        deleteCell.appendChild(deleteButton);

        // สร้างปุ่ม "สัญญา"
        var contractCell = row.cells[15]; // เปลี่ยนตำแหน่งของเซลล์เป็น [15]
        var contractButton = document.createElement('button');
        contractButton.textContent = 'ยึดทรัพย์';
        contractButton.onclick = function() {
            location.href = 'ยึดทรัพย์.html';
        };
        contractCell.appendChild(contractButton);

        // สร้างปุ่ม "สัญญา"
        var contractCell = row.cells[16]; // เปลี่ยนตำแหน่งของเซลล์เป็น [15]
        var contractButton = document.createElement('button');
        contractButton.textContent = 'คืนเงิน';
        contractButton.onclick = function() {
            location.href = 'คืนเงิน.html';
        };
        contractCell.appendChild(contractButton);
    }
</script>







<script>
    // ฟังก์ชั่นสำหรับคำนวณเวลาที่เลยกำหนดสัญญา
    function calculateOverdue(returnDateCell) {
        // ดึงข้อมูลวันที่ปัจจุบัน
        var currentDate = new Date();
    
        // ดึงข้อมูลวันที่ต้องคืน
        var returnDate = new Date(returnDateCell.innerText);
    
        // คำนวณเวลาที่เลยกำหนดสัญญา
        var overdueDays = Math.ceil((currentDate - returnDate) / (1000 * 60 * 60 * 24));
        
        return overdueDays;
    }


    // ฟังก์ชันสำหรับเริ่มต้นหน้าเว็บ
    function initPage() {
    // เลือกตารางที่มี id เพื่อดึงข้อมูล
    var table = document.getElementById("your_table_id");
    // หา rows ของตาราง
    var rows = table.getElementsByTagName("tr");

    // วน loop ผ่านทุก rows เริ่มต้นที่ index 1 เพราะ row แรกเป็น header
    for (var i = 1; i < rows.length; i++) {
        // หา cells ของแต่ละ row
        var cells = rows[i].getElementsByTagName("td");
    
        // ดึงข้อมูลที่ต้องการคำนวณ
        var ดอกเบี้ย = parseFloat(cells[7].innerText); // ดอกเบี้ย
        var เงินต้น = parseFloat(cells[6].innerText); // เงินต้น
        var ระยะเวลากู้ = parseFloat(cells[4].innerText); // ระยะเวลากู้
        var ดอกเบี้ยยกมา = parseFloat(cells[9].innerText)

        // คำนวณเวลาที่เลยกำหนดสัญญา
        var overdueDays = calculateOverdue(cells[5]);

        // ตรวจสอบว่าเลยกำหนดสัญญาหรือไม่
        if (overdueDays > 0) {
            // แทรกข้อมูลเวลาที่เลยกำหนดสัญญาลงในเซลล์ "เลยกำหนดสัญญา" ของแถวนั้น
            cells[13].innerText = overdueDays + " วัน"; // เปลี่ยน index เป็นตำแหน่งของเซลล์ "เลยกำหนดสัญญา" และเพิ่มข้อความ "วัน"
            // เปลี่ยนสถานะเป็น "เลยกำหนดสัญญา"
            cells[12].innerText = "เลยกำหนดสัญญา";
            cells[12].style.color = 'rgb(242, 160, 9)';
        } else if (overdueDays == 0) {
            // เปลี่ยนสถานะเป็น "ครบกำหนดชำระ"
            cells[12].innerText = "ครบกำหนดชำระ";
            cells[12].style.color = 'rgb(248, 7, 204)';
            cells[13].innerText = "";
        } else  {
            // เปลี่ยนสถานะเป็น "อยู่ในสัญญา"
            cells[12].innerText = "อยู่ในสัญญา";
            cells[12].style.color = 'rgb(26, 133, 233)';
            cells[13].innerText = "";
        }

        // ไม่ต้องตรวจสอบเงื่อนไขเลยกำหนดสัญญาซ้ำอีกที่นี่
        // เพราะเงื่อนไขได้ถูกตรวจสอบและการกำหนดค่าถูกทำแล้วในส่วนของเงื่อนไขด้านบน

        // คำนวณดอกเบี้ยปรับและแสดงผลลัพธ์ใน cell ที่ต้องการ
       // คำนวณดอกเบี้ยปรับและแสดงผลลัพธ์ใน cell ที่ต้องการ
        if (overdueDays > 0) {
          var ดอกเบี้ยปรับ = ((ดอกเบี้ย / เงินต้น) / ระยะเวลากู้) * เงินต้น * overdueDays;
          cells[8].innerText = ดอกเบี้ยปรับ.toFixed(); // แสดงที่ cell ดอกเบี้ยปรับ
        } else {
          ดอกเบี้ยปรับ = 0; // กำหนดให้ค่าดอกเบี้ยปรับเป็น 0 ถ้าไม่มีการชำระเกินกำหนด
          cells[8].innerText = ""; // เซลล์เป็นค่าว่างถ้าไม่มีดอกเบี้ยปรับ
        }

          // คำนวณรวมดอกเบี้ยที่ต้องคืนและแสดงผลลัพธ์ใน cell ที่ต้องการ
          var รวมดอกเบี้ยที่ต้องคืน = ดอกเบี้ย + ดอกเบี้ยปรับ + (isNaN(ดอกเบี้ยยกมา) ? 0 : ดอกเบี้ยยกมา);
          cells[10].innerText = รวมดอกเบี้ยที่ต้องคืน.toFixed(); // แสดงที่ cell รวมดอกเบี้ยที่ต้องคืน

          // คำนวณเงินที่ต้องคืนและแสดงผลลัพธ์ใน cell ที่ต้องการ
          var เงินที่ต้องคืน = เงินต้น + รวมดอกเบี้ยที่ต้องคืน;
          cells[11].innerText = เงินที่ต้องคืน.toFixed(); // แสดงที่ cell เงินที่ต้องคืน

    }
}

// เรียกใช้ฟังก์ชัน initPage เมื่อหน้าเว็บโหลดเสร็จ
window.onload = function() {
    initPage();
};


 
</script>




<script>
    // เลือกเซลล์ทั้งหมดที่อยู่ในคอลัมน์ที่ 12 และตรวจสอบว่ามีข้อความ "ชำระครบ" หรือไม่
    var cells = document.querySelectorAll('#your_table_id td:nth-child(13)');
  
    cells.forEach(function(cell) {
      var text = cell.innerText.trim();
      if (text === "ชำระครบ") {
        cell.classList.add('s');
      } 
      if (text === "ต่อดอก") {
        cell.classList.add('s');
      }
      if (text === "เเบล็คลิช") {
        cell.classList.add('b');
      }

    });

    


</script>



</body>
</html>
