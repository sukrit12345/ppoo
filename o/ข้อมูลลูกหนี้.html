<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<title>ตารางลูกหนี้</title>

<style>
.navbar {
        overflow: hidden;
        background-color: #333;
        position: fixed;
        top: 0;
        width: 100%;
        left: 0;
        right: 0;
    }

.navbar a {
        float: left;
        display: block;
        color: white;
        text-align: center;
        padding: 14px 20px;
        text-decoration: none;
    }
.navbar a:hover {
        background-color: #ddd;
        color: black;
    }
.navbar a.active {
        background-color: #555;
        color: white;
    }
    

body {
        font-family: Arial, sans-serif;
        background-color: #ffffff;
        margin-top: 100px;
    }

.container {
  width: 60%;
  margin: auto;
  margin-top: 50px;
}

table {
        border-collapse: collapse;
        width: 100%;
        margin: auto;
        margin-top: 80px;
    }

th, td {
        border: 1px solid #dddddd;
        text-align: center;
        padding: 8px;
    }

th {
        background-color: #333;
        color: white;
    }

tr:nth-child(even) {
        background-color: #f2f2f2;
    }    



.search-container {
  display: flex;
  justify-content: center;
  margin-bottom: 20px;
}

.search-container input[type=text] {
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 4px;
  outline: none;
}

.search-container button {
  background-color: #4CAF50;
  color: white;
  padding: 10px 20px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

.search-container button:hover {
  background-color: #45a049;
}



.search-container2 {
  display: flex;
  justify-content: center;
  align-items: center; /* จัดให้อยู่ตรงกลางตามแนวตั้ง */
  margin-bottom: 20px;
}

.search-container2 input[type=text] {
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 4px;
  outline: none;
  margin-right: 5px; /* เพิ่มระยะห่างของ input กับปุ่มค้นหา */
}

.search-container2 button {
  background-color: #4CAF50;
  color: white;
  padding: 10px 20px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

.search-container2 button:hover {
  background-color: #45a049;
}

.search-container2 select {
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 4px;
  outline: none;
  margin-left: 5px; /* เพิ่มระยะห่างของปุ่มค้นหา กับ dropdown */
}


.button-container {
    text-align: center;
    margin-top: 20px;
}

.custom-button {
    background-color: #4CAF50;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

.custom-button:hover {
    background-color: #45a049;
}

.button-link {
    text-decoration: none;
    color: white;
}


/* Common styles */
.column {
        float: left;
        width: 33.33%;
        padding: 0 15px;
        box-sizing: border-box;
    }

    /* Style for totalDebtorsInContract */
    #totalDebtorsInContract {
        font-size: 16px;
        color: #000000;
        margin-top: 5px;
    }

    /* Style for totalIDCard */
    #totalIDCard {
        font-size: 16px;
        color: #000000;
        margin-top: 5px;
    }

    /* Style for debtorsWithInterest */
    #debtorsWithInterest {
        font-size: 16px;
        color: #000000;
        margin-top: 5px;
    }

    /* Style for debtorsWithContracts */
    #debtorsWithContracts {
        font-size: 16px;
        color: #000000;
        margin-top: 5px;
    }
    #debtorsWhoExceededContracts {
        font-size: 16px;
        color: #000000;
        margin-top: 5px;
    }

    /* Style for fullyPaidDebtors */
    #fullyPaidDebtors {
        font-size: 16px;
        color: #000000;
        margin-top: 5px;
    }

    /* Style for debtorsBlacklist */
    #debtorsBlacklist {
        font-size: 16px;
        color: #000000;
        margin-top: 5px;
    }

    /* Style for totalPrincipalAmount */
    #totalPrincipalAmount {
        font-size: 16px;
        color: #000000;
        margin-top: 5px;
    }

    /* Style for totalInterestAmount */
    #totalInterestAmount {
        font-size: 16px;
        color: #000000;
        margin-top: 5px;
    }

    /* Style for totalRefundAmount */
    #totalRefundAmount {
        font-size: 16px;
        color: #000000;
        margin-top: 5px;
    }

    /* Style for totalPrincipal */
    #totalPrincipal {
        font-size: 16px;
        color: #000000;
        margin-top: 5px;
    }

    /* Style for totalShare */
    #totalAccumulatedInterest {
        font-size: 16px;
        color: #000000;
        margin-top: 5px;
    }

    /* Style for totalNetProfit */
    #totalNetProfit {
        font-size: 16px;
        color: #000000;
        margin-top: 5px;
    }

    /* Clear floats after the columns */
    .row:after {
        content: "";
        display: table;
        clear: both;
    }



.s {
   color: green;
}

.b {
    color: red;
}
.w {
    color: rgb(26, 133, 233);
}

.l {
    color: rgb(242, 160, 9);
}
.d{
    color:rgb(248, 7, 204)
}


</style>
</head>
<body>
  <div class="navbar">
    <a class="active" href="ข้อมูลลูกหนี้.html">ข้อมูลลูกหนี้</a>
    <a href="รายงานผล.html">รายงานผล</a>
    <a href="เช็คสถานะ.html">เช็คสถานะ</a>
    <a href="คลังทรัพย์สิน.html">คลังทรัพย์สิน</a>
    <a href="ผู้จัดการเ.html">ผู้จัดการ</a>
    <a href="กองทุน.html">กองทุน</a>
    <a href="ประวัติการทำรายการ.html">ประวัติการทำรายการ</a>
    <a href="เเจ้งเตือน.html">เเจ้งเตือน</a>
    <a href="ตั้งค่า.html">ตั้งค่า</a>
</div>

<h2 style="text-align:center;">ตารางลูกหนี้</h2>




<div class="search-container">
  <input type="text" id="searchInput" placeholder="พิมพ์เลขบัตรประชาชน...">
  <button type="button" onclick="searchTable()">ค้นหาเลขบัตรประชาชน</button>
</div>

<script>
    function searchTable() {
      var input, filter, table, tr, td, i, j, txtValue;
      input = document.getElementById("searchInput");
      filter = input.value.trim(); // ตัดช่องว่างที่อาจเกิดขึ้นได้
      
      // ตรวจสอบว่าเลขบัตรประชาชนมีความยาว 13 หลักหรือไม่
      if (filter.length !== 13 || isNaN(filter)) {
        alert("โปรดป้อนเลขบัตรประชาชนที่ถูกต้อง (13 หลัก)");
        return;
      }
    
      // ค้นหาในทุกคอลัมน์
      table = document.querySelector("table");
      tr = table.getElementsByTagName("tr");
    
      for (i = 0; i < tr.length; i++) {
        var found = false; // เพิ่มตัวแปรเพื่อตรวจสอบว่าพบข้อมูลหรือไม่
    
        for (j = 0; j < tr[i].cells.length; j++) {
          td = tr[i].getElementsByTagName("td")[j];
          if (td) {
            txtValue = td.textContent || td.innerText;
            // เปรียบเทียบข้อมูลในคอลัมน์กับค่าที่ค้นหา
            if (txtValue.trim() === filter) {
              found = true;
              break;
            }
          }
        }
    
        if (found) {
          tr[i].style.display = ""; // แสดงแถวที่พบข้อมูล
        } else {
          // ตรวจสอบว่าอิลิเมนต์ที่กำลังตรวจสอบเป็น <th> หรือไม่
          if (tr[i].getElementsByTagName("th").length === 0) {
            tr[i].style.display = "none"; // ซ่อนแถวที่ไม่พบข้อมูล
          }
        }
      }
    }
    
</script>



<div class="row">
    <div class="column">
        <div class="search-container">
            <input type="text" id="newSearchInput1" placeholder="พิมพ์ชื่อผู้จัดการ">
            <button type="button" onclick="customSearch1()">ค้นหาผู้จัดการ</button>
        </div>        
    </div>
    <div class="column">
        <div class="search-container">
            <input type="text" id="newSearchInput2" placeholder="พิมพ์ชื่อหัวหน้าสาขา">
            <button type="button" onclick="customSearch2()">ค้นหาหัวหน้าสาขา</button>
        </div>        
    </div>
    <div class="column">
        <div class="search-container">
            <input type="text" id="newSearchInput3" placeholder="พิมพ์ชื่อผู้รับดูเเล">
            <button type="button" onclick="customSearch3()">ค้นหาผู้รับดูเเล</button>
        </div>        
    </div>

</div>
  

<script>
    function customSearch1() {
        var input, filter, table, tr, td, i, txtValue;
        input = document.getElementById("newSearchInput1"); // เปลี่ยน ID ใหม่ที่นี่
        filter = input.value.toUpperCase();
        table = document.getElementsByTagName("table")[0];
        tr = table.getElementsByTagName("tr");
        for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td")[14]; // แก้ index เป็นตำแหน่งที่ต้องการค้นหา ในที่นี้คือ คอลัมน์ที่ 16 (index 15)
            if (td) {
                txtValue = td.textContent || td.innerText;
                // ใช้เงื่อนไขเพิ่มเติมเพื่อให้ค้นหาได้ทั้งตัวเล็กและตัวใหญ่
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
        }
    }
</script>


<script>
function customSearch2() {
    var input, filter, table, tr, td, i, txtValue;
    input = document.getElementById("newSearchInput2"); // เปลี่ยน ID ใหม่ที่นี่
    filter = input.value.toUpperCase();
    table = document.getElementsByTagName("table")[0];
    tr = table.getElementsByTagName("tr");
    for (i = 0; i < tr.length; i++) {
        td = tr[i].getElementsByTagName("td")[16]; // แก้ index เป็นตำแหน่งที่ต้องการค้นหา ในที่นี้คือ คอลัมน์ที่ 16 (index 15)
        if (td) {
            txtValue = td.textContent || td.innerText;
            // ใช้เงื่อนไขเพิ่มเติมเพื่อให้ค้นหาได้ทั้งตัวเล็กและตัวใหญ่
            if (txtValue.toUpperCase().indexOf(filter) > -1) {
                tr[i].style.display = "";
            } else {
                tr[i].style.display = "none";
            }
        }
    }
}
</script>


<script>
    function customSearch3() {
        var input, filter, table, tr, td, i, txtValue;
        input = document.getElementById("newSearchInput3"); // เปลี่ยน ID ใหม่ที่นี่
        filter = input.value.toUpperCase();
        table = document.getElementsByTagName("table")[0];
        tr = table.getElementsByTagName("tr");
        for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td")[15]; // แก้ index เป็นตำแหน่งที่ต้องการค้นหา ในที่นี้คือ คอลัมน์ที่ 16 (index 15)
            if (td) {
                txtValue = td.textContent || td.innerText;
                // ใช้เงื่อนไขเพิ่มเติมเพื่อให้ค้นหาได้ทั้งตัวเล็กและตัวใหญ่
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
        }
    }
</script>






<div class="search-container2">
  <select id="statusFilter">
    <option value="" selected>ทั้งหมด</option>
    <option value="อยู่ในสัญญา">อยู่ในสัญญา</option>
    <option value="เลยกำหนดสัญญา">เลยกำหนดสัญญา</option>
    <option value="ครบกำหนดชำระ">ครบกำหนดชำระ</option>
    <option value="ชำระครบ">ชำระครบ</option>
    <option value="เเบล็คลิช">เเบล็คลิช</option>
  </select>
  <button type="button" onclick="searchIdCard2()">ค้นหาสถานะ</button>
</div>



<script>
    window.onload = function() {
        searchIdCard2();
    };
    function searchIdCard2() {
        var statusFilter, table, tr, i, found;
        statusFilter = document.getElementById("statusFilter").value;

        table = document.querySelector("table");
        tr = table.getElementsByTagName("tr");

        for (i = 0; i < tr.length; i++) {
            found = false;

            if (tr[i].getElementsByTagName("td").length > 0) {
                if (tr[i].cells[8].innerText.trim() === statusFilter || statusFilter === "") {
                    found = true;
                }

                if (found) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
                }
            }
        }
        

        // Call calculateTotalPrincipalAmount() after filtering
        calculateTotalPrincipalAmount();
        calculateTotalInterestAmount();
        calculateTotalRefundAmount();
        
    }
</script>



  
  



<div class="row">
  <div class="column">
    <div style="text-align: center;">ยอดเงินรวมที่กำลังใช้งาน</div>
    <div id="totalPrincipalAmount" style="text-align: center;">เงินต้นทั้งหมด:</div>
    <div id="totalInterestAmount" style="text-align: center;">ดอกเบี้ยทั้งหมด:</div>
    <div id="totalRefundAmount" style="text-align: center;">เงินที่ต้องคืนทั้งหมด</div>
  </div>
  <div class="column">
    <div id="totalIDCard" style="text-align: center;"></div>
    <div id="totalDebtorsInContract" style="text-align: center;"></div>
    <div id="debtorsWithContracts" style="text-align: center;"></div>
    <div id="debtorsWhoExceededContracts" style="text-align: center;"></div>
    <div id="fullyPaidDebtors" style="text-align: center;"></div>
    <div id="debtorsBlacklist" style="text-align: center;"></div>
  </div>
  <div class="column">
    <div style="text-align: center;">ยอดเงินรวมที่ใช้งานเเล้ว</div>
    <div id="totalPrincipal" style="text-align: center;"></div>
    <div id="totalAccumulatedInterest" style="text-align: center;"></div>
    <div id="totalNetProfit" style="text-align: center;"></div>
  </div>
</div>



<script>
     function calculateTotalPrincipalAmount() {
        var table = document.querySelector("table");
        var tr = table.getElementsByTagName("tr");
        var totalPrincipalAmount = 0;

        for (var i = 1; i < tr.length; i++) {
            if (tr[i].getElementsByTagName("td").length > 0 && tr[i].style.display !== "none") {
                var principalAmount = parseFloat(tr[i].cells[5].innerText.trim());
                if (!isNaN(principalAmount)) {
                    totalPrincipalAmount += principalAmount;
                }
            }
        }

        var resultContainer = document.getElementById("totalPrincipalAmount");
        resultContainer.textContent = "เงินต้นทั้งหมด: " + totalPrincipalAmount.toLocaleString() + " บาท";
    }
</script>

  
  
  
  <script>
    function calculateTotalInterestAmount() {
        var table = document.querySelector("table");
        var tr = table.getElementsByTagName("tr");
        var totalInterestAmount = 0;

        for (var i = 1; i < tr.length; i++) {
            if (tr[i].getElementsByTagName("td").length > 0 && tr[i].style.display !== "none") {
                var interestAmount = parseFloat(tr[i].cells[6].innerText.trim());
                if (!isNaN(interestAmount)) {
                    totalInterestAmount += interestAmount;
                }
            }
        }

        var resultContainer = document.getElementById("totalInterestAmount");
        resultContainer.textContent = "ดอกเบี้ยทั้งหมด: " + totalInterestAmount.toLocaleString() + " บาท";
    }

  </script>
  
  
  
  
  <script>
    function calculateTotalRefundAmount() {
        var table = document.querySelector("table");
        var tr = table.getElementsByTagName("tr");
        var totalRefundAmount = 0;

        for (var i = 1; i < tr.length; i++) {
            if (tr[i].getElementsByTagName("td").length > 0 && tr[i].style.display !== "none") {
                var refundAmount = parseFloat(tr[i].cells[7].innerText.trim());
                if (!isNaN(refundAmount)) {
                    totalRefundAmount += refundAmount;
                }
            }
        }

        var resultContainer = document.getElementById("totalRefundAmount");
        resultContainer.textContent = "เงินที่ต้องคืนทั้งหมด: " + totalRefundAmount.toLocaleString() + " บาท";
    }
  </script>
  




  <!-- Script to calculate total share -->
  <script>
    document.addEventListener("DOMContentLoaded", function() {
        // Call calculateTotalIDCard() when the HTML document is loaded
        calculateTotalIDCard();
    });

    function calculateTotalIDCard() {
        var table = document.querySelector("table");
        var tr = table.getElementsByTagName("tr");
        var totalIDCard = [];

        // Start from i = 1 to skip the table header row
        for (var i = 1; i < tr.length; i++) {
            if (tr[i].getElementsByTagName("td").length > 0) {
                // Get the ID card number from the cell at index 1 (starting from 0)
                var idCard = tr[i].cells[2].innerText.trim();
                if (idCard !== "") {
                    totalIDCard.push(idCard);
                }
            }
        }

        // Count unique ID card numbers
        var uniqueIDCardCount = new Set(totalIDCard).size;

        // Display the result in the element with id "totalIDCard"
        var resultContainer = document.getElementById("totalIDCard");
        resultContainer.textContent = "ลูกหนี้ในระบบทั้งหมด: " + uniqueIDCardCount +' คน';
    }
  </script>




<!-- Script to calculate total debtors in contract -->
<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Call calculateTotalDebtorsInContract() when the HTML document is loaded
        calculateTotalDebtorsInContract();
    });

    function calculateTotalDebtorsInContract() {
        var table = document.querySelector("table");
        var tr = table.getElementsByTagName("tr");
        var totalDebtors = [];

        // Start from i = 1 to skip the table header row
        for (var i = 1; i < tr.length; i++) {
            if (tr[i].getElementsByTagName("td").length > 0) {
                // Get the status from the cell at index 8 (starting from 0)
                var status = tr[i].cells[8].innerText.trim(); // Changed from 8 to 7

                // Check if the status contains the phrase "อยู่ในสัญญา"
                if (status.includes("อยู่ในสัญญา")) {
                    totalDebtors.push("dummy"); // Just push a dummy value to count the debtors
                }
            }
        }

        // Count total debtors in contract
        var totalDebtorsCount = totalDebtors.length;

        // Display the result in the element with id "totalDebtorsInContract"
        var resultContainer = document.getElementById("totalDebtorsInContract");
        resultContainer.textContent = "ลูกหนี้อยู่ในสัญญา: " + totalDebtorsCount + ' คน';
    }
</script>


<!-- Script to calculate total debtors with contracts -->
<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Call calculateTotalDebtorsWithContracts() when the HTML document is loaded
        calculateTotalDebtorsWithContracts();
    });

    function calculateTotalDebtorsWithContracts() {
        var table = document.querySelector("table");
        var tr = table.getElementsByTagName("tr");
        var totalDebtors = [];

        // Start from i = 1 to skip the table header row
        for (var i = 1; i < tr.length; i++) {
            if (tr[i].getElementsByTagName("td").length > 0) {
                // Get the status from the cell at index 8 (starting from 0)
                var status = tr[i].cells[8].innerText.trim();

                // Check if the status contains the phrase "ครบกำหนดชำระ"
                if (status.includes("ครบกำหนดชำระ")) {
                    totalDebtors.push("dummy"); // Just push a dummy value to count the debtors
                }
            }
        }

        // Count total debtors with contracts
        var totalDebtorsCount = totalDebtors.length;

        // Display the result in the element with id "debtorsWithContracts"
        var resultContainer = document.getElementById("debtorsWithContracts");
        resultContainer.textContent = "ลูกหนี้ครบกำหนดชำระ: " + totalDebtorsCount + ' คน';
    }
</script>


<!-- Script to calculate total debtors who exceeded contracts -->
<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Call calculateTotalDebtorsWhoExceededContracts() when the HTML document is loaded
        calculateTotalDebtorsWhoExceededContracts();
    });

    function calculateTotalDebtorsWhoExceededContracts() {
        var table = document.querySelector("table");
        var tr = table.getElementsByTagName("tr");
        var totalDebtors = [];

        // Start from i = 1 to skip the table header row
        for (var i = 1; i < tr.length; i++) {
            if (tr[i].getElementsByTagName("td").length > 0) {
                // Get the status from the cell at index 8 (starting from 0)
                var status = tr[i].cells[8].innerText.trim();

                // Check if the status contains the phrase "เลยกำหนดสัญญา"
                if (status.includes("เลยกำหนดสัญญา")) {
                    totalDebtors.push("dummy"); // Just push a dummy value to count the debtors
                }
            }
        }

        // Count total debtors who exceeded contracts
        var totalDebtorsCount = totalDebtors.length;

        // Display the result in the element with id "debtorsWhoExceededContracts"
        var resultContainer = document.getElementById("debtorsWhoExceededContracts");
        resultContainer.textContent = "ลูกหนี้เลยกำหนดสัญญา: " + totalDebtorsCount + ' คน';
    }
</script>




<!-- Script to calculate total debtors who have fully paid -->
<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Call calculateFullyPaidDebtors() when the HTML document is loaded
        calculateFullyPaidDebtors();
    });

    function calculateFullyPaidDebtors() {
        var table = document.querySelector("table");
        var tr = table.getElementsByTagName("tr");
        var fullyPaidDebtors = [];

        // Start from i = 1 to skip the table header row
        for (var i = 1; i < tr.length; i++) {
            if (tr[i].getElementsByTagName("td").length > 0) {
                // Get the status from the cell at index 8 (starting from 0)
                var status = tr[i].cells[8].innerText.trim();

                // Check if the status contains the phrase "ชำระครบ"
                if (status.includes("ชำระครบ")) {
                    fullyPaidDebtors.push("dummy"); // Just push a dummy value to count the fully paid debtors
                }
            }
        }

        // Count total fully paid debtors
        var totalFullyPaidDebtorsCount = fullyPaidDebtors.length;

        // Display the result in the element with id "fullyPaidDebtors"
        var resultContainer = document.getElementById("fullyPaidDebtors");
        resultContainer.textContent = "ลูกหนี้ชำระครบ: " + totalFullyPaidDebtorsCount + ' คน';
    }
</script>





<!-- Script to calculate total debtors on blacklist -->
<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Call calculateDebtorsBlacklist() when the HTML document is loaded
        calculateDebtorsBlacklist();
    });

    function calculateDebtorsBlacklist() {
        var table = document.querySelector("table");
        var tr = table.getElementsByTagName("tr");
        var debtorsBlacklist = [];

        // Start from i = 1 to skip the table header row
        for (var i = 1; i < tr.length; i++) {
            if (tr[i].getElementsByTagName("td").length > 0) {
                // Get the status from the cell at index 8 (starting from 0)
                var status = tr[i].cells[8].innerText.trim();

                // Check if the status contains the phrase "อยู่ในสัญญา"
                if (status.includes("เเบล็คลิช")) {
                    debtorsBlacklist.push("dummy"); // Just push a dummy value to count the debtors
                }
            }
        }

        // Count total debtors on blacklist
        var totalDebtorsBlacklistCount = debtorsBlacklist.length;

        // Display the result in the element with id "debtorsBlacklist"
        var resultContainer = document.getElementById("debtorsBlacklist");
        resultContainer.textContent = "ลูกหนี้เเบล็คลิช: " + totalDebtorsBlacklistCount + ' คน';
    }
</script>






<script>
document.addEventListener("DOMContentLoaded", function() {
    // Call calculateTotalPrincipal() when the HTML document is loaded
    calculateTotalPrincipal();
});

function calculateTotalPrincipal() {
    var table = document.querySelector("table");
    var tr = table.getElementsByTagName("tr");
    var totalPrincipal = 0;

    // Start from i = 1 to skip the table header row
    for (var i = 1; i < tr.length; i++) {
        if (tr[i].getElementsByTagName("td").length > 0) {
            // Get the principal amount from the cell at index 8 (starting from 0)
            var principal = parseFloat(tr[i].cells[9].innerText.trim());
            if (!isNaN(principal)) {
                totalPrincipal += principal;
            }
        }
    }

    // Display the result in the element with id "totalPrincipal"
    var resultContainer = document.getElementById("totalPrincipal");
    resultContainer.textContent = "เงินต้นปล่อยสะสมทั้งหมด: " + totalPrincipal.toLocaleString() + " บาท";
}
</script>




<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Call calculateTotalAccumulatedInterest() when the HTML document is loaded
        calculateTotalAccumulatedInterest();
    });
    
    function calculateTotalAccumulatedInterest() {
        var table = document.querySelector("table");
        var tr = table.getElementsByTagName("tr");
        var totalShareAmount = 0; // เปลี่ยนชื่อตัวแปรเป็น totalShareAmount
    
        // Start from i = 1 to skip the table header row
        for (var i = 1; i < tr.length; i++) {
            if (tr[i].getElementsByTagName("td").length > 0) {
                // Get the share amount from the cell at index 9 (starting from 0)
                var share = parseFloat(tr[i].cells[10].innerText.trim()); // คำนวณค่าที่เซลล์ที่ 10
                if (!isNaN(share)) {
                    totalShareAmount += share; // เพิ่มค่าลงในตัวแปร totalShareAmount
                }
            }
        }
    
        // Display the result in the element with id "totalAccumulatedInterest"
        var resultContainer = document.getElementById("totalAccumulatedInterest");
        resultContainer.textContent = "ดอกเบี้ยสะสมทั้งหมด: " + totalShareAmount.toLocaleString() + " บาท";
    }
    </script>
    




<script>
document.addEventListener("DOMContentLoaded", function() {
    // เรียกใช้ calculateTotalNetProfit() เมื่อเอกสาร HTML โหลดเสร็จ
    calculateTotalNetProfit();
});

function calculateTotalNetProfit() {
    var table = document.querySelector("table");
    var tr = table.getElementsByTagName("tr");
    var totalNetProfit = 0;

    for (var i = 1; i < tr.length; i++) {
        if (tr[i].getElementsByTagName("td").length > 0) {
            var profit = parseFloat(tr[i].cells[11].innerText.trim());
            if (!isNaN(profit)) {
                totalNetProfit += profit;
            }
        }
    }

    // แสดงผลลัพธ์ใน element ที่กำหนด เช่น div หรือ span
    var resultContainer = document.getElementById("totalNetProfit");
    resultContainer.textContent = "กำไรสุทธิสะสมทั้งหมด: " + totalNetProfit.toLocaleString() + " บาท";
}
</script>




<div class="button-container">
    <button class="custom-button">
        <a href="/Adddebtorinformation" class="button-link">เพิ่มข้อมูลลูกหนี้</a>
    </button>
</div>




<script>
function confirmDelete() {
    if (confirm("คุณต้องการทำรายการนี้ใช่หรือไม่?")) {
        location.href = 'ข้อมูลลูกหนี้.html';
    } else {
        // ไม่ต้องทำอะไร
    }
}
</script>




<table id= your_table_id >
  <tr>
    <th>ลำดับ</th>
    <th>วันที่บันทึก</th>
    <th>เลขบัตรประชาชน</th>
    <th>ชื่อ</th>
    <th>นามสกุล</th>
    <th>เงินต้น</th>
    <th>ดอกเบี้ย</th>
    <th>เงินที่ต้องคืน</th>
    <th>สถานะ</th>
    <th>เงินต้นสะสม</th>
    <th>ดอกเบี้ยสะสม</th>
    <th>กำไรสุทธิสะสม</th>
    <th>จัดการข้อมูล</th>
    <th>สัญญา</th>
    <th>ผู้จัดการ</th>
    <th>ผู้จัดการดูเเล</th>
    <th>หัวหน้าสาขา</th>
  </tr>
  <tr>
    <td>06</td>
    <td>2024-04-13</td>
    <td>9876553210987</td>
    <td>Jane</td>
    <td >Smith</td>
    <td>1000</td>
    <td>100</td>
    <td>1100</td>
    <td>เเบล็คลิช</td>
    <td>3000</td>
    <td>210</td>
    <td>490</td>
    <td></td>
    <td></td>
    <td>John Smith</td>
    <td>-</td>
    <td>John Smith</td>
  </tr>

  <tr>
    <td>05</td>
    <td>2024-04-13</td>
    <td>9076543210987</td>
    <td>rtt</td>
    <td >Smith</td>
    <td>1000</td>
    <td>100</td>
    <td>1100</td>
    <td>ชำระครบ</td>
    <td>3000</td>
    <td>210</td>
    <td>490</td>
    <td></td>
    <td></td>
    <td>key</td>
    <td>-</td>
    <td>John Smith</td>
  </tr>
  <tr>
    <td>04</td>
    <td>2024-04-13</td>
    <td>9876543200987</td>
    <td>mfvmf</td>
    <td >Smith</td>
    <td>1000</td>
    <td>100</td>
    <td>1100</td>
    <td>เลยกำหนดสัญญา</td>
    <td>3000</td>
    <td>210</td>
    <td>490</td>
    <td> </td>
    <td></td>
    <td>-</td>
    <td>-</td>
    <td>John Smith</td>
  </tr>

  <tr>
    <td>03</td>
    <td>2024-04-13</td>
    <td>9876543210888</td>
    <td>www</td>
    <td >Smith</td>
    <td>1000</td>
    <td>100</td>
    <td>1100</td>
    <td>ครบกำหนดชำระ</td>
    <td>3000</td>
    <td>210</td>
    <td>490</td>
    <td> </td>
    <td></td>
    <td>John Smith</td>
    <td>-</td>
    <td>John Smith</td>
  </tr>
  

  <tr>
    <td>02</td>
    <td>2024-04-13</td>
    <td>9876543210987</td>
    <td>www</td>
    <td >Smith</td>
    <td>1000</td>
    <td>100</td>
    <td>1100</td>
    <td>อยู่ในสัญญา</td>
    <td>3000</td>
    <td>210</td>
    <td>490</td>
    <td> </td>
    <td></td>
    <td>John Smith</td>
    <td>-</td>
    <td>John Smith</td>
  </tr>

  <tr>
    <td>02</td>
    <td>2024-04-13</td>
    <td>9876543210987</td>
    <td>www</td>
    <td >Smith</td>
    <td>1000</td>
    <td>100</td>
    <td>1100</td>
    <td>อยู่ในสัญญา</td>
    <td>3000</td>
    <td>210</td>
    <td>490</td>
    <td> </td>
    <td></td>
    <td>John Smith</td>
    <td>-</td>
    <td>John Smith</td>
  </tr>

  <tr>
    <td>02</td>
    <td>2024-04-13</td>
    <td>9876543210987</td>
    <td>www</td>
    <td >Smith</td>
    <td>1000</td>
    <td>100</td>
    <td>1100</td>
    <td>อยู่ในสัญญา</td>
    <td>3000</td>
    <td>210</td>
    <td>490</td>
    <td> </td>
    <td></td>
    <td>John Smith</td>
    <td>-</td>
    <td>John Smith</td>
  </tr>

  <tr>
    <td>02</td>
    <td>2024-04-13</td>
    <td>9876543210987</td>
    <td>www</td>
    <td >Smith</td>
    <td>1000</td>
    <td>100</td>
    <td>1100</td>
    <td>อยู่ในสัญญา</td>
    <td>3000</td>
    <td>210</td>
    <td>490</td>
    <td> </td>
    <td></td>
    <td>John Smith</td>
    <td>-</td>
    <td>John Smith</td>
  </tr>



  <tr>
    <td>02</td>
    <td>2024-04-13</td>
    <td>9876543210987</td>
    <td>www</td>
    <td >Smith</td>
    <td>1000</td>
    <td>100</td>
    <td>1100</td>
    <td>อยู่ในสัญญา</td>
    <td>3000</td>
    <td>210</td>
    <td>490</td>
    <td> </td>
    <td></td>
    <td>John Smith</td>
    <td>-</td>
    <td>John Smith</td>
  </tr>



  <tr>
    <td>02</td>
    <td>2024-04-13</td>
    <td>9876543210987</td>
    <td>www</td>
    <td >Smith</td>
    <td>1000</td>
    <td>100</td>
    <td>1100</td>
    <td>อยู่ในสัญญา</td>
    <td>3000</td>
    <td>210</td>
    <td>490</td>
    <td> </td>
    <td></td>
    <td>John Smith</td>
    <td>-</td>
    <td>John Smith</td>
  </tr>


  <tr>
    <td>02</td>
    <td>2024-04-13</td>
    <td>9876543210987</td>
    <td>www</td>
    <td >Smith</td>
    <td>1000</td>
    <td>100</td>
    <td>1100</td>
    <td>อยู่ในสัญญา</td>
    <td>3000</td>
    <td>210</td>
    <td>490</td>
    <td> </td>
    <td></td>
    <td>John Smith</td>
    <td>-</td>
    <td>John Smith</td>
  </tr>


  <tr>
    <td>02</td>
    <td>2024-04-13</td>
    <td>9876543210987</td>
    <td>www</td>
    <td >Smith</td>
    <td>1000</td>
    <td>100</td>
    <td>1100</td>
    <td>อยู่ในสัญญา</td>
    <td>3000</td>
    <td>210</td>
    <td>490</td>
    <td> </td>
    <td></td>
    <td>John Smith</td>
    <td>-</td>
    <td>John Smith</td>
  </tr>


  <tr>
    <td>02</td>
    <td>2024-04-13</td>
    <td>9876543210987</td>
    <td>www</td>
    <td >Smith</td>
    <td>1000</td>
    <td>100</td>
    <td>1100</td>
    <td>อยู่ในสัญญา</td>
    <td>3000</td>
    <td>210</td>
    <td>490</td>
    <td> </td>
    <td></td>
    <td>John Smith</td>
    <td>-</td>
    <td>John Smith</td>
  </tr>
  <tbody>
    <!-- ข้อมูลจะถูกเพิ่มที่นี่โดย JavaScript -->
  </tbody>
  

</table>




<script>
    // เลือกตาราง
    var table = document.querySelector('#your_table_id');
    // เลือกแถวของตาราง
    var rows = Array.from(table.querySelectorAll('tr'));

    // วนลูปทุกแถวเพื่อกำหนดลำดับตัวเลขจากมากไปน้อย
    rows.forEach(function(row, index) {
        // ตรวจสอบว่าไม่ใช่แถวแรก
        if (index > 0) {
            // สร้างเซลล์แรกของแถว
            var cell = row.cells[0]; // เซลล์แรกมี index เป็น 0
            // กำหนดลำดับลงในเซลล์แรกของแถว โดยเรียงจากมากไปน้อย
            cell.textContent = rows.length - index; 
        }
    });
</script>



<script>
    // เลือกตาราง
    var table = document.querySelector('#your_table_id');
    // เลือกแถวของตาราง
    var rows = table.querySelectorAll('tr');

    // วนลูปทุกแถวเพื่อเพิ่มปุ่มในเซลล์ที่ 14, 15, และ 16 โดยไม่นับแถวแรก
    for (var i = 1; i < rows.length; i++) {
        var row = rows[i];
        
        // สร้างปุ่ม "ดู"
        var viewCell = row.cells[12];
        var viewButton = document.createElement('button');
        viewButton.textContent = 'ดู';
        viewButton.onclick = function() {
            location.href = 'ดูสัญญาที่สร้าง.html';
        };
        viewCell.appendChild(viewButton);

        // สร้างปุ่ม "แก้ไข"
        var editCell = row.cells[12]; // แก้ไขตำแหน่งของเซลล์เป็น [13]
        var editButton = document.createElement('button');
        editButton.textContent = 'แก้ไข';
        editButton.onclick = function() {
            location.href = 'แก้ไข.html'; // แก้ไขการกำหนดลิงค์ไปยังหน้าแก้ไข
        };
        editCell.appendChild(editButton);

        // สร้างปุ่ม "ลบ"
        var deleteCell = row.cells[12]; // แก้ไขตำแหน่งของเซลล์เป็น [14]
        var deleteButton = document.createElement('button');
        deleteButton.textContent = 'ลบ';
        deleteButton.onclick = function() {
            confirmDelete();
        };
        deleteCell.appendChild(deleteButton);

        // สร้างปุ่ม "สัญญา"
        var contractCell = row.cells[13]; // เปลี่ยนตำแหน่งของเซลล์เป็น [15]
        var contractButton = document.createElement('button');
        contractButton.textContent = 'สัญญา';
        contractButton.onclick = function() {
            location.href = 'สัญญา.html';
        };
        contractCell.appendChild(contractButton);
    }
</script>




<script>
    // เลือกเซลล์ทั้งหมดที่อยู่ในคอลัมน์ที่ 12 และตรวจสอบว่ามีข้อความ "ชำระครบ" หรือไม่
    var cells = document.querySelectorAll('#your_table_id td:nth-child(9)');
  
    cells.forEach(function(cell) {
      var text = cell.innerText.trim();
      if (text === "ชำระครบ") {
        cell.classList.add('s');
      }
      if (text === "อยู่ในสัญญา") {
        cell.classList.add('w');
      } 
      if (text === "เเบล็คลิช") {
        cell.classList.add('b');
      }
      if (text === "เลยกำหนดสัญญา") {
        cell.classList.add('l');
      }
      if (text === "ครบกำหนดชำระ") {
        cell.classList.add('d');
      } 

    });
</script>

</body>
</html>
